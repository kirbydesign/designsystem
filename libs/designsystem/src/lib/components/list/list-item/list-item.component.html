<ion-item-sliding
  [class.selected]="listComponent.isSelectable && item === listComponent.selectedItem"
  [kirbyListItemColor]="listComponent.getItemColor"
  [item]="item"
  [disabled]="listComponent.isSwipingEnabled ? null : true"
  keyHandler
  [ngClass]="orderClass"
  class="ion-item-sliding"
  (click)="listComponent.isSelectable ? listComponent.onItemSelect(item) : null"
>
  <ng-container
    *ngTemplateOutlet="swipeActionsTemplate; context: { $implicit: item }"
  ></ng-container>
  <ng-container
    *ngTemplateOutlet="defaultItemTemplate; context: { $implicit: item }"
  ></ng-container>
</ion-item-sliding>

<ng-template #defaultItemTemplate let-item>
  <ng-container
    *ngTemplateOutlet="
      listComponent.hasDeprecatedItemTemplate ? deprecatedItemTemplate : listComponent.itemTemplate;
      context: { $implicit: item }
    "
  ></ng-container>
</ng-template>

<ng-template #deprecatedItemTemplate let-item>
  <ion-item
    [button]="listComponent.isSelectable ? true : null"
    [attr.tabindex]="listComponent.isSelectable ? null : 0"
    detail="false"
  >
    <ng-container
      *ngTemplateOutlet="listComponent.legacyItemTemplate; context: { $implicit: item }"
    ></ng-container>
    <ng-container
      *ngTemplateOutlet="listComponent.legacyFlexItemTemplate; context: { $implicit: item }"
    ></ng-container>
  </ion-item>
</ng-template>

<ng-template #swipeActionsTemplate let-item>
  <ion-item-options
    *ngIf="listComponent.hasSwipeActions(item)"
    [side]="listComponent.getSwipeActionEnd(item)"
  >
    <div class="swipe-action">
      <ng-container *ngFor="let swipeAction of listComponent.getSwipeActions(item)">
        <ion-item-option
          [ngClass]="listComponent.getSwipeActionType(swipeAction, item)"
          (click)="listComponent.onSwipeActionSelect(swipeAction, item, $event)"
        >
          <div class="item-content">
            <kirby-icon
              *ngIf="listComponent.getSwipeActionIcon(swipeAction, item)"
              size="sm"
              [name]="listComponent.getSwipeActionIcon(swipeAction, item)"
            >
            </kirby-icon>
            <ion-label>
              {{ listComponent.getSwipeActionTitle(swipeAction, item) }}
            </ion-label>
          </div>
        </ion-item-option>
      </ng-container>
    </div>
  </ion-item-options>
</ng-template>
