@use '@kirbydesign/core/src/scss/interaction-state';
@use '@kirbydesign/core/src/scss/utils';

:host {
  --kirby-card-main-background-color: #{utils.get-color('white')};
  --kirby-card-main-color: #{utils.get-color('white-contrast')};
  --kirby-card-footer-background-color: #{utils.get-color('white')};
  --kirby-card-footer-color: #{utils.get-color('white-contrast')};

  // can we set some kind of theme variable here to forward to our interaction-states instead?

  // default context + .kirby-color-brightness-white
  // primary is always the same, so this is just added here temporarily for clarity
  --kirby-button-background-color-att-lvl-1: #{utils.get-color('primary')};
  --kirby-button-color-att-lvl-1: #{utils.get-color('primary-contrast')};
  --kirby-button-background-color-att-lvl-2: #{utils.get-color('black')};
  --kirby-button-color-att-lvl-2: #{utils.get-color('black-contrast')};
  --kirby-button-background-color-att-lvl-3: rgb(28 28 28 / 4%);
  --kirby-button-color-att-lvl-3: #{utils.get-color('white-contrast')};

  &.kirby-color-brightness-dark {
    // contents in mixin to be shared
    // primary is always the same, so this is just added here temporarily for clarity
    --kirby-button-background-color-att-lvl-1: #{utils.get-color('primary')};
    --kirby-button-color-att-lvl-1: #{utils.get-color('primary-contrast')};
    --kirby-button-background-color-att-lvl-2: #{utils.get-color('white')};
    --kirby-button-color-att-lvl-2: #{utils.get-color('white-contrast')};
    --kirby-button-background-color-att-lvl-3: rgb(255 255 255 / 15%);
    --kirby-button-color-att-lvl-3: #{utils.get-color('black-contrast')};
  }

  &.kirby-color-brightness-light {
    // contents in mixin to be shared

    // primary is always the same, so this is just added here temporarily for clarity
    --kirby-button-background-color-att-lvl-1: #{utils.get-color('primary')};
    --kirby-button-color-att-lvl-1: #{utils.get-color('primary-contrast')};
    --kirby-button-background-color-att-lvl-2: #{utils.get-color('black')};
    --kirby-button-color-att-lvl-2: #{utils.get-color('black-contrast')};
    --kirby-button-background-color-att-lvl-3: #{utils.get-color('white')};
    --kirby-button-color-att-lvl-3: #{utils.get-color('white-contrast')};
  }

  @include interaction-state.extend-content {
    display: inherit;
    flex-direction: inherit;
    justify-content: inherit;
  }

  border-radius: utils.$border-radius;
  box-shadow: utils.get-elevation(2);
  color: var(--kirby-card-main-color);
  background-color: var(--kirby-card-main-background-color);
  background-image: var(--kirby-card-background-image);
  background-repeat: var(--kirby-card-background-repeat, no-repeat);
  background-position: var(--kirby-card-background-position, center);
  background-size: var(--kirby-card-background-size, cover);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  overflow: hidden;
  position: relative;
  z-index: utils.z('default');
  width: var(--kirby-card-width, auto);

  .content-wrapper {
    &.padding {
      padding-top: var(--kirby-card-padding-top, utils.size('s'));
      padding-bottom: var(--kirby-card-padding-bottom, utils.size('s'));
      padding-inline: utils.size('s');
    }
  }

  &.highlighted {
    box-shadow: utils.get-elevation(4);
  }

  &.flat {
    box-shadow: none;
  }

  &[role='button'] {
    @include interaction-state.initialize-layer;
    @include interaction-state.apply-hover('xxxs');
    @include interaction-state.apply-active('xxs');
    @include interaction-state.apply-focus-visible($shadow: utils.get-elevation(2));

    &.highlighted {
      @include interaction-state.apply-focus-visible($shadow: utils.get-elevation(4));
    }

    &.interaction-state-make-lighter-and-louder {
      @include interaction-state.apply-hover('xxs', $make-lighter: true);
      @include interaction-state.apply-active('s', $make-lighter: true);
    }

    outline: none;
  }
}

:host-context(.swiper-slide-active) {
  box-shadow: utils.get-elevation(4);
  transition: all 0.5s;
  transform: translateY(-3px);
}

@each $color-name, $color-value in utils.$main-colors {
  :host(.#{$color-name}) {
    --kirby-card-main-background-color: #{utils.get-color($color-name)};
    --kirby-card-main-color: #{utils.get-color($color-name + '-contrast')};
  }
}
