@import '../../scss/utils';

@mixin button-sm {
  font-size: font-size('xs');
  height: size('l');
  --kirby-button-padding-left: #{size('s')};
  --kirby-button-padding-right: #{size('s')};
  --kirby-button-padding-top: #{size('xxxs')};
  --kirby-button-padding-bottom: #{size('xxxs')};

  &.icon-only {
    width: size('l');
  }

  &.icon-left,
  &.icon-right {
    ::ng-deep kirby-icon {
      --kirby-icon-font-size: #{size('s')};
    }
  }
}

@mixin button-lg {
  font-size: font-size('n');
  height: size('xxl');
  min-width: 220px;

  &.icon-only {
    width: size('xxl');
  }
}

@mixin button-attentionlevel1 {
  --kirby-button-background-color: #{get-color('primary')};
  --kirby-button-color: #{get-color('primary-contrast')};

  &.destructive {
    --kirby-button-background-color: #{get-color('danger')};
    --kirby-button-color: #{get-color('danger-contrast')};
  }
}

@mixin button-attentionlevel2 {
  --kirby-button-background-color: #{get-color('white')};
  --kirby-button-color: #{get-color('white-contrast')};

  &.destructive {
    --kirby-button-background-color: #{get-color('light')};
    --kirby-button-color: #{get-color('danger')};
  }
}

@mixin button-attentionlevel3 {
  --kirby-button-color: #{get-color('medium-contrast')};
  border: 1px solid var(--kirby-button-border-color, #{get-color('medium')});

  &.destructive {
    --kirby-button-color: #{get-color('danger')};
  }
}

@mixin button-attentionlevel4 {
  --kirby-button-background-color: transparent;
  --kirby-button-color: #{get-color('primary-contrast')};

  &.destructive {
    --kirby-button-color: #{get-color('danger')};
  }
}

:host {
  --kirby-button-border-radius: #{$border-radius-round};
  --kirby-button-padding-left: #{size('m')};
  --kirby-button-padding-right: #{size('m')};
  --kirby-button-padding-top: 0;
  --kirby-button-padding-bottom: 0;
  align-items: center;
  background-color: var(--kirby-button-background-color);
  border-radius: var(--kirby-button-border-radius);
  border: none;
  box-sizing: border-box;
  color: var(--kirby-button-color);
  cursor: pointer;
  display: inline-flex;
  flex-direction: row;
  font-family: var(--kirby-font-family);
  justify-content: center;
  transition: opacity 200ms linear;
  user-select: none;
  vertical-align: middle;
  white-space: nowrap;

  // we default to 'md' size.
  margin: size('xxxs');
  padding: var(--kirby-button-padding-top) var(--kirby-button-padding-right)
    var(--kirby-button-padding-bottom) var(--kirby-button-padding-left);
  font-size: font-size('s');
  height: size('xl');
  line-height: line-height('s');

  &.sm {
    @include button-sm;
  }

  &.lg {
    @include button-lg;
  }

  &.attention-level1 {
    @include button-attentionlevel1;
  }

  &.attention-level2 {
    @include button-attentionlevel2;
  }

  &.attention-level3 {
    @include button-attentionlevel3;
  }

  &.attention-level4 {
    @include button-attentionlevel4;
  }

  &.icon-left {
    --kirby-button-padding-left: #{size('xxs')};
    --kirby-button-padding-right: #{size('s')};

    ::ng-deep kirby-icon {
      --kirby-icon-margin-right: #{size('xxs')};
    }
  }

  &.icon-right {
    --kirby-button-padding-left: #{size('s')};
    --kirby-button-padding-right: #{size('xxs')};

    ::ng-deep kirby-icon {
      --kirby-icon-margin-left: #{size('xxs')};
    }
  }

  &.icon-only {
    width: size('xl');
    padding: 0;
    min-width: unset;
  }

  &[expand='block'] {
    width: 100%;
  }

  &:hover,
  &:focus {
    opacity: 0.8;
  }

  &:disabled {
    background-color: get-color('semi-light');
    border-color: get-color('semi-light');
    pointer-events: none;
    --kirby-button-color: #{get-color('semi-dark-shade')};
  }

  :host-context(.default),
  :host-context(.kirby-color-brightness-white) {
    &.attention-level2 {
      --kirby-button-background-color: #{get-color('black')};
      --kirby-button-color: #{get-color('black-contrast')};
    }
  }

  :host-context(.kirby-color-brightness-dark) {
    &.attention-level3 {
      --kirby-button-border-color: #{get-color('white')};
      --kirby-button-color: #{get-color('white')};
    }
    &.attention-level4 {
      --kirby-button-color: #{get-color('white')};
    }
  }

  &.floating {
    $fab-size: 64px;
    width: $fab-size !important;
    height: $fab-size !important;
    min-width: unset;

    &:not(:disabled) {
      box-shadow: get-elevation(8);
    }
  }
}

:host-context(kirby-item)[slot='end'] {
  margin-inline-start: size('s');
}

// Temp fix for https://github.com/angular/angular-cli/issues/13854#issuecomment-470831308
/* clean-css ignore:start */
:host-context(ion-toolbar kirby-page-actions) {
  &.attention-level1,
  &.attention-level2,
  &.attention-level3,
  &.attention-level4 {
    @include button-attentionlevel4;
    @include button-sm;
  }
}
/* clean-css ignore:end */

// Temp fix for https://github.com/angular/angular-cli/issues/13854#issuecomment-470831308
/* clean-css ignore:start */
:host-context(.page-title kirby-page-actions) {
  &.attention-level1,
  &.attention-level2,
  &.attention-level3,
  &.attention-level4 {
    @include button-attentionlevel2;
  }
}
/* clean-css ignore:end */
